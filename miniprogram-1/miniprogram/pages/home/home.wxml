<view class="home-container">
    <!-- åŠ è½½çŠ¶æ€ -->
    <view class="loading-overlay" wx:if="{{isLoading}}">
        <view class="loading-spinner">
            <view class="spinner-ring"></view>
            <text class="loading-text">æ­£åœ¨åŠ è½½...</text>
        </view>
    </view>

    <!-- é¡¶éƒ¨å¯¼èˆªæ  -->
    <view class="header">
        <view class="header-bg"></view>
        <view class="header-content">
            <view class="logo-section">
                <view class="logo-container">
                    <text class="logo-icon">ğŸŒº</text>
                    <view class="logo-glow"></view>
                </view>
                <view class="app-info">
                    <text class="app-name">å…°èŠ±è¯†åˆ«ä¸“å®¶</text>
                    <text class="app-subtitle">AIæ™ºèƒ½è¯†åˆ«Â·ä¸“ä¸šå…»æŠ¤</text>
                </view>
            </view>
            <view class="header-actions">
                <button class="scan-btn" bindtap="goToRecognition">
                    <view class="scan-btn-inner">
                        <text class="scan-icon">ğŸ“¸</text>
                        <text class="scan-text">è¯†åˆ«</text>
                    </view>
                    <view class="scan-btn-glow"></view>
                </button>
            </view>
        </view>
    </view>

    <!-- æœç´¢æ  -->
    <view class="search-section">
        <view class="search-container">
            <view class="search-box">
                <text class="search-icon">ğŸ”</text>
                <input class="search-input" placeholder="æœç´¢å…°èŠ±å“ç§ã€ç‰¹å¾..." bindinput="onSearch" value="{{searchKeyword}}" />
                <view class="search-btn" wx:if="{{searchKeyword}}" bindtap="clearSearch">
                    <text class="clear-icon">âœ•</text>
                </view>
            </view>
        </view>
    </view>

    <!-- åˆ†ç±»å¯¼èˆª -->
    <view class="category-nav">
        <scroll-view class="category-scroll" scroll-x="true" show-scrollbar="false">
            <view class="category-list">
                <view class="category-item" wx:for="{{categories}}" wx:key="id" bindtap="selectCategory" data-id="{{category.id}}" class="{{selectedCategory === category.id ? 'active' : ''}}">
                    <view class="category-icon-container">
                        <text class="category-icon">{{category.icon}}</text>
                    </view>
                    <text class="category-name">{{category.name}}</text>
                    <view class="category-active-dot" wx:if="{{selectedCategory === category.id}}"></view>
                </view>
            </view>
        </scroll-view>
    </view>

    <!-- å…°èŠ±å“ç§å±•ç¤º -->
    <view class="orchids-section">
        <view class="section-header">
            <view class="section-title-container">
                <text class="section-title">{{getCurrentCategoryName()}}</text>
                <view class="section-count-badge">
                    <text class="section-count">{{filteredOrchids.length}}</text>
                </view>
            </view>
            <view class="section-decoration"></view>
        </view>

        <view class="orchids-grid" wx:if="{{filteredOrchids.length > 0}}">
            <view class="orchid-card" wx:for="{{filteredOrchids}}" wx:key="_id" bindtap="showOrchidDetail" data-orchid="{{orchid}}">
                <view class="card-image">
                    <image class="orchid-image" src="{{orchid.image}}" mode="aspectFill"/>
                    <view class="image-gradient"></view>
                    <view class="image-overlay">
                        <view class="popularity-badge" wx:if="{{orchid.isPopular}}">
                            <text class="badge-text">ğŸ”¥ çƒ­é—¨</text>
                        </view>
                    </view>
                </view>

                <view class="card-content">
                    <view class="orchid-info">
                        <text class="orchid-name">{{orchid.name}}</text>
                        <text class="orchid-latin">{{orchid.latin}}</text>
                    </view>

                    <view class="orchid-features">
                        <view class="feature-tag" wx:for="{{orchid.features.slice(0, 3)}}" wx:key="feature">
                            <text class="feature-text">{{feature}}</text>
                        </view>
                    </view>

                    <view class="card-footer">
                        <view class="difficulty-section">
                            <text class="difficulty-label">éš¾åº¦</text>
                            <view class="difficulty-indicator">
                                <view class="difficulty-dot" wx:for="{{5}}" wx:key="i" class="{{i <= orchid.difficulty ? 'active' : ''}}"></view>
                            </view>
                        </view>
                        <view class="detail-arrow">
                            <text class="arrow-text">â†’</text>
                        </view>
                    </view>
                </view>

                <view class="card-shine"></view>
            </view>
        </view>

        <!-- ç©ºçŠ¶æ€ -->
        <view class="empty-state"  wx:if="{{!isLoading}}">
            <view class="empty-animation">
                <text class="empty-icon">ğŸŒ¸</text>
                <view class="empty-particles">
                    <view class="particle" wx:for="{{6}}" wx:key="i"></view>
                </view>
            </view>
            <text class="empty-title">æš‚æ— ç›¸å…³æ•°æ®</text>
            <text class="empty-subtitle">è¯•è¯•å…¶ä»–æœç´¢æ¡ä»¶æˆ–åˆ·æ–°é¡µé¢</text>
            <button class="refresh-btn" bindtap="loadData">
                <text class="refresh-text">ğŸ”„ åˆ·æ–°æ•°æ®</text>
            </button>
        </view>

        <!-- åŠ è½½æ›´å¤š -->
        <view class="load-more" wx:if="{{hasMore && !isLoading}}">
            <button class="load-more-btn" bindtap="loadMore" disabled="{{loadingMore}}">
                <view class="load-more-content">
                    <view class="load-spinner" wx:if="{{loadingMore}}"></view>
                    <text class="load-text">{{loadingMore ? 'åŠ è½½ä¸­...' : 'æŸ¥çœ‹æ›´å¤š'}}</text>
                </view>
            </button>
        </view>
    </view>

    <!-- å…°èŠ±è¯¦æƒ…å¼¹çª— -->
    <view class="detail-modal" wx:if="{{showDetail}}" bindtap="closeDetail">
        <view class="modal-backdrop"></view>
        <view class="modal-content" bindtap="stopPropagation">
            <view class="modal-header">
                <button class="close-btn" bindtap="closeDetail">
                    <text class="close-icon">âœ•</text>
                </button>
            </view>

            <view class="detail-content" wx:if="{{selectedOrchid}}">
                <view class="detail-image">
                    <image class="detail-orchid-image" src="{{selectedOrchid.image}}" mode="aspectFill"/>
                    <view class="detail-image-overlay"></view>
                </view>

                <view class="detail-info">
                    <view class="detail-title">
                        <text class="detail-name">{{selectedOrchid.name}}</text>
                        <text class="detail-latin">{{selectedOrchid.latin}}</text>
                    </view>

                    <view class="detail-description">
                        <text class="description-text">{{selectedOrchid.description}}</text>
                    </view>

                    <view class="detail-features">
                        <text class="features-title">ğŸŒŸ ä¸»è¦ç‰¹å¾</text>
                        <view class="features-grid">
                            <view class="feature-item" wx:for="{{selectedOrchid.features}}" wx:key="feature">
                                <view class="feature-bullet"></view>
                                <text class="feature-desc">{{feature}}</text>
                            </view>
                        </view>
                    </view>

                    <view class="care-info">
                        <text class="care-title">ğŸŒ± å…»æŠ¤æŒ‡å—</text>
                        <view class="care-grid">
                            <view class="care-item">
                                <view class="care-icon">â˜€ï¸</view>
                                <text class="care-label">å…‰ç…§</text>
                                <text class="care-value">{{selectedOrchid.care.light}}</text>
                            </view>
                            <view class="care-item">
                                <view class="care-icon">ğŸŒ¡ï¸</view>
                                <text class="care-label">æ¸©åº¦</text>
                                <text class="care-value">{{selectedOrchid.care.temperature}}</text>
                            </view>
                            <view class="care-item">
                                <view class="care-icon">ğŸ’§</view>
                                <text class="care-label">æ¹¿åº¦</text>
                                <text class="care-value">{{selectedOrchid.care.humidity}}</text>
                            </view>
                            <view class="care-item">
                                <view class="care-icon">ğŸš¿</view>
                                <text class="care-label">æµ‡æ°´</text>
                                <text class="care-value">{{selectedOrchid.care.watering}}</text>
                            </view>
                        </view>
                    </view>
                </view>
            </view>
        </view>
    </view>
</view>
